!function(e,t){function r(e){var t={},r={type:"contentType",name:"query",withParents:"withParent"};e.parentType&&e.parentId&&(t[e.parentType+"Id"]=e.parentId);for(var i in e)n(e,i)&&e[i]&&(t[n(r,i)?r[i]:i]=e[i]);return t}function n(e,t){return e.hasOwnProperty(t)}function i(e){var r=t.console;r&&r.error&&r.error(e)}e.kladr={},function(){var r="https:"==t.location.protocol?"https:":"http:";e.kladr.url=r+"//kladr-api.ru/api.php"}(),e.kladr.type={region:"region",district:"district",city:"city",street:"street",building:"building"},e.kladr.typeCode={city:1,settlement:2,village:4},e.kladr.validate=function(t){var r=e.kladr.type;switch(t.type){case r.region:case r.district:case r.city:if(t.parentType&&!t.parentId)return i("parentId undefined"),!1;break;case r.street:if(t.parentType!=r.city)return i('parentType must equal "city"'),!1;if(!t.parentId)return i("parentId undefined"),!1;break;case r.building:if(!t.zip){if(!~e.inArray(t.parentType,[r.street,r.city]))return i('parentType must equal "street" or "city"'),!1;if(!t.parentId)return i("parentId undefined"),!1}break;default:if(!t.oneString)return i("type incorrect"),!1}return t.oneString&&t.parentType&&!t.parentId?(i("parentId undefined"),!1):t.typeCode&&t.type!=r.city?(i('type must equal "city"'),!1):!(t.limit<1)||(i("limit must greater than 0"),!1)},e.kladr.api=function(t,n){if(!n)return void i("Callback undefined");if(!e.kladr.validate(t))return void n([]);var a=setTimeout(function(){n([]),a=null},3e3);e.getJSON(e.kladr.url+"?callback=?",r(t),function(e){a&&(n(e.result||[]),clearTimeout(a))})},e.kladr.check=function(t,r){return r?(t.withParents=!1,t.limit=1,void e.kladr.api(t,function(e){r(e&&e.length?e[0]:!1)})):void i("Callback undefined")}}(jQuery,window);