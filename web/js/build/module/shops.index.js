define(["jquery","underscore","yandexmaps","mustache"],function(t,n,e,a){function s(t){t.preventDefault(),o()}function r(n){n.preventDefault();var e=t(this).data("partnerSlug");t(this).hasClass("selected")?(t(this).removeClass("selected"),h[e]=!1):(t(this).addClass("selected"),h[e]=!0),o({partners:i()})}function i(){var t=[];return n.each(h,function(n,e){n&&t.push(e)}),t}function c(n){var e=n||{};t.ajax({url:"/ajax/get-shops",data:e,type:"POST",success:function(n){var e=t("#tpl-points-list").html();t(".points__list").html(a.render(e,n.data))}})}function o(t){l.val().length>0&&(d.phrase=l.val()+" "+f),void 0!==t&&t.partners&&(d.partners=t.partners),c(d)}var u=t(".js-search-points-form"),l=t(".js-search-points-input"),p=t(".js-partner-icon"),h={},d={},f=t("body").data("config").region.name;u.on("submit",s),p.on("click",r),function(){p.each(function(){h[t(this).data("partnerSlug")]=!1})}()});