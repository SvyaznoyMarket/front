define(["jquery","underscore","yandexmaps","mustache"],function(t,n,e,a){function s(t){t.preventDefault(),c()}function r(n){n.preventDefault();var e=t(this).data("partnerSlug");t(this).hasClass("selected")?(t(this).removeClass("selected"),d[e]=!1):(t(this).addClass("selected"),d[e]=!0),c({partners:i()})}function i(){var t=[];return n.each(d,function(n,e){n&&t.push(e)}),t}function o(n){var e=n||{};t.ajax({url:"/ajax/get-shops",data:e,type:"POST",success:function(n){var e=t("#tpl-points-list").html();t(".points__list").html(a.render(e,n.data))}})}function c(t){p.val().length>0&&(h.phrase=p.val()+" "+f),void 0!==t&&t.partners&&(h.partners=t.partners),o(h)}var l=(t("body"),t(".js-search-points-form")),p=t(".js-search-points-input"),u=t(".js-partner-icon"),d={},h={},f=t("body").data("config").region.name;l.on("submit",s),u.on("click",r),function(){u.each(function(){d[t(this).data("partnerSlug")]=!1})}();var v=navigator.userAgent,m=v.indexOf("Mozilla/5.0")>-1&&v.indexOf("Android ")>-1&&v.indexOf("AppleWebKit")>-1&&!(v.indexOf("Chrome")>-1);m&&t(".points__container-scroll").css({bottom:t(".points-top").height()})});