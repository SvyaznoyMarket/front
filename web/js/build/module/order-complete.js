define(["require","jquery","underscore","mustache","module/util","module/config","jquery.ui","jquery.maskedinput","module/order/user.form","module/order/common"],function(o,e,n,t){var a=e("body"),r=e("#tpl-order-complete-onlinePayment-popup"),i=e("#tpl-modalWindow"),l=function(o){var n=e(this),l=e(i.html()).appendTo(a),d=n.data("modal-title"),c=n.data("modal-position"),s=e.parseJSON(e(n.data("storageSelector")).html());console.info(s),o.stopPropagation(),l.find(".js-modal-title").text(d),l.addClass(c),l.lightbox_me({onLoad:function(){l.find(".js-modal-content").append(t.render(r.html(),s))},beforeClose:function(){}})},d=function(o){var n=e(this),t=e(n.data("containerSelector")),a=t.data("url"),r=n.data("value");o.stopPropagation(),console.info(n,t),e.ajax({url:a,data:r,type:"post",timeout:4e4}).done(function(o){t.html(o.form)}).always(function(){console.info("unblock screen")}).error(function(o){var n,t;o&&302===o.status&&(n=e.parseJSON(o.responseText)||{},t=n.redirect||"/cart",window.location.href=t)})};a.on("click",".js-order-delivery-onlinePayment-link",l),a.on("click",".js-order-delivery-onlinePayment-radio",d)});