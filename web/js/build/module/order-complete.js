define(["require","jquery","underscore","mustache","module/util","module/config","jquery.ui","jquery.maskedinput","module/order/user.form","module/order/common","module/order/toggle"],function(o,e,n,t){var r=e("body"),a=e("#tpl-order-complete-onlinePayment-popup"),i=e("#tpl-modalWindow"),l=function(o){var n=e(this),l=e(i.html()).appendTo(r),d=n.data("modal-title"),u=n.data("modal-position"),c=e.parseJSON(e(n.data("storageSelector")).html());console.info(c),o.stopPropagation(),l.find(".js-modal-title").text(d),l.addClass(u),l.lightbox_me({onLoad:function(){l.find(".js-modal-content").append(t.render(a.html(),c))},beforeClose:function(){}})},d=function(o){var n=e(this),t=e(n.data("containerSelector")),r=t.data("url"),a=n.data("value");o.stopPropagation(),console.info(n,t),e.ajax({url:r,data:a,type:"post",timeout:4e4}).done(function(o){t.html(o.form)}).always(function(){console.info("unblock screen")}).error(function(o){var n,t;o&&302===o.status&&(n=e.parseJSON(o.responseText)||{},t=n.redirect||"/cart",window.location.href=t)})};r.on("click",".js-order-delivery-onlinePayment-link",l),r.on("click",".js-order-delivery-onlinePayment-radio",d)});