define(["require","jquery","underscore","mustache","module/util","module/config","jquery.ui","jquery.maskedinput","module/order/user.form","module/order/common","module/order/toggle"],function(o,e,t,n){var r=e("body"),a=e("#tpl-order-delivery-onlinePayment-popup"),d=e("#tpl-modalWindow"),i=function(o){var t=e(this),i=e(d.html()).appendTo(r),l=t.data("modal-title"),u=t.data("modal-position"),c=Storage.get(t.data("storageSelector"));o.stopPropagation(),i.find(".js-modal-title").text(l),i.addClass(u),i.lightbox_me({onLoad:function(){i.find(".js-modal-content").append(n.render(a.html(),c))},beforeClose:function(){}})},l=function(o){var t=e(this),n=e(t.data("containerSelector")),r=n.data("url");o.stopPropagation(),console.info(t,n),e.ajax({url:r,data:data,type:"post",timeout:4e4}).done(function(o){n.html(o.form)}).always(function(){console.info("unblock screen")}).error(function(o){var t,n;o&&302===o.status&&(t=e.parseJSON(o.responseText)||{},n=t.redirect||"/cart",window.location.href=n)})};r.on("click",".js-order-delivery-onlinePayment-link",i),r.on("click",".js-order-delivery-onlinePayment-radio",l)});